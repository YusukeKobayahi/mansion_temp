FROM node:14.15.0-slim

ARG CORE_API_URL
ARG SALES_FORM_URL
ARG SENTRY_DSN
ARG GA_TRACKING_ID
ARG GA4_TRACKING_ID

ENV LANG C.UTF-8
ENV TZ Asia/Tokyo
ENV NODE_ENV production
ENV PORT 3000

ENV NEXT_PUBLIC_CORE_API_URL $CORE_API_URL
ENV NEXT_PUBLIC_SALES_FORM_URL $SALES_FORM_URL

WORKDIR /app

COPY . /app
RUN yarn install
RUN yarn build

EXPOSE $PORT

CMD ["yarn", "start"]
